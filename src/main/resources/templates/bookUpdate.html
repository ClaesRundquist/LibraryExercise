<!DOCTYPE html>
<html lang="sv-se">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create and Search Form</title>
<link rel="icon" href="../static/favicon.ico" th:href="@{/favicon.ico}" />
<link rel="stylesheet" type="text/css" href="../static/css/forms.css"
	th:href="@{/css/forms.css}">

<title>Create Book</title>
</head>
<body>
	<div id="updateDiv">
		<form id="updateBookForm" th:method="patch" th:action="@{/updateForm}"
			th:object="${book}">
			<div id=updateFields>
				<label for="id">Book Id</label>
				<input class="disabled" type="text" th:field="*{id}"  />
					<br />
				<label for="isbn">ISBN</label>
				<input type="text" th:field="*{isbn}" />
					<br />
				<label for="title">Title</label>
				<input type="text" th:field="*{title}" /> <input type="button" id="searchTitle" value="Search" />
					<br />
				<label for="author">Author</label>
				<input type="text" th:field="*{author}" />
				<br />
				<label for="gengre">Genre</label>
				<input type="text" th:field="*{genre}" />
					<br />
				<label for="location">Location</label>
				<input type="text" th:field="*{location}" />
				<br />
				<label for="loanperiod">Loan period</label>
				<input type="text" th:field="*{loanPeriod}" />
				<br />
				<div id="updateFieldsSubmit">
					<input type="submit" id="update" value="Update" />
				</div>
			</div>
		</form>

	</div>
  	<div id="res"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>


function populate(frm, data) {
	  $.each(data, function(key, value){
	    $('[name='+key+']', frm).val(value);
	  });
	}

	$("#searchTitle").click(

    	function(){$.ajax({ 
    	   type: "GET",
    	   dataType: "text",
    	   url: "http://localhost:8080/book/findbytitle/"+$('#title').val(),
    	   success: function(data){        
   // 		   $("#res").html(data);
    		   populate('#updateBookForm', $.parseJSON(data).books[1]);
    	   }
    	})
    	
    });


	
</script>
</body>

</html>